@model IEnumerable<WebApplication4.Models.OrderItem>

@{
    ViewData["Title"] = "Index";
}
<div style="display: flex; justify-content: center; align-items: center; gap: 30px; margin-top: 50px;">

    <div style="background-color: #f4f7fa; border-radius: 10px; padding: 20px; width: 200px; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease, box-shadow 0.3s ease;">
        <h3 style="font-size: 18px; color: #333; margin-bottom: 10px;">Total Gear Requested</h3>
        <p style="font-size: 24px; font-weight: bold; color: #2b7a78; margin-top: 10px;">@ViewBag.GearRequestedNumber</p>
    </div>

    <div style="background-color: #f4f7fa; border-radius: 10px; padding: 20px; width: 200px; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease, box-shadow 0.3s ease;">
        <h3 style="font-size: 18px; color: #333; margin-bottom: 10px;">Available Stock</h3>
        <p style="font-size: 24px; font-weight: bold; color: #2b7a78; margin-top: 10px;">@ViewBag.StockNumber</p>
    </div>
</div>


@if(ViewBag.Status == 2)
{
<table class="table">
    <thead>
        <tr>
            <th>Item</th>
            <th>Stock Allocation</th>
        </tr>
    </thead>
    <tbody>


     
        @foreach (var orderItem in Model)
        {
            if (!orderItem.GearAssigned)
            {
                <tr>

                    <td>@orderItem.Items.Name</td>
                    <td>
                        
                        <form asp-action="a2">
                            <input type="hidden" value="@orderItem.OrderId" name="OrderId"/>
                            <label for="stock-@orderItem.ItemId">Select Item</label>
                            <select name="StockId" class="form-select" onchange="this.form.submit()">
                                <option value="" disabled selected>Select an option</option>
                                @foreach (var stock in ViewBag.Stock)
                                {
                                    if (stock.ItemId == orderItem.ItemId)
                                    {
                                        <option value="@stock.StockId">
                                            @orderItem.Items.Name (@stock.StockId)
                                        </option>
                                    }
                                }
                            </select>
                        </form>
                    </td>
                </tr>
            }
        }
        </tbody>
    </table>
    }
     else
       {

    <div class="alert alert-info text-center" Style="Margin-top: 5%;">
        <h2>Order Already Processed</h2>
        <p>To Unassign Items From User click here </p>
        <form asp-controller="Stocks" asp-action="Index">

            <input type="hidden" name="SearchTerm" value="@ViewBag.UserSID">
            <input type="submit" class="btn btn-primary" > value="Go to Stock Page" />

        </form>
    </div>


       }
      
 

<table class="table">
    <thead>
        <tr>
            <th colspan="2" style="background-color: lightgreen;">
                <strong>Allocated Stock:</strong>
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var userStock in ViewBag.UserStock)
        {
            <tr>
                <td>
                    @userStock.Items.Name - @userStock.StockId
                </td>
                <td>
          

                    <form asp-action="UA">
                        @if (Model != null && Model.Any())
                        {
                            <input type="hidden" value="@Model.First().OrderId" name="OrderId" />
                        }

                        else
                        {

                            <input type="hidden" value="@ViewBag.OrderId" name="OrderId" />
                        }

                     

                        <input type="hidden" value="@userStock.StockId" name="StockId" />
                        @if(ViewBag.Status == 2)
                        {
                            <input type="submit" value="Unassign" class="btn btn-primary" style="background-color: red"/>
                        }
                        else{
                            <input value="Unassign" class="btn btn-primary" style="background-color: red; opacity: 50%;" lo/>


                            
                            }
                        </form>
                </td>
            </tr>
        }
    </tbody>
</table>

                    <form asp-action="Confirm">
                        @if (Model != null && Model.Any())
                        {

                            <input type="hidden" value="@Model.First().OrderId" name="OrderId" />
                        }

                        else
                        {

                            <input type="hidden" value="@ViewBag.OrderId" name="OrderId" />
                        }

    @if (Model == null || !Model.Any())
    {
        if (ViewBag.Status == 4 || ViewBag.Status == 3)
            {
            <input type="submit" value="Confirm and Notify User Their Order is Ready" class="btn btn-primary" style="background-color: dodgerblue; opacity: 50%;" />

            }
            else
            {
            <input  value="Confirm and Notify User Their Order is Ready" class="btn btn-primary" style="background-color: dodgerblue" />

            }
    }

                        </form>