@model IEnumerable<WebApplication4.Models.OrderItem>

@{
    ViewData["Title"] = "My Cart";
    double orderCost = 0;
}

<div class="container mt-5">
    <h2 class="text-center mb-4">Ordered Items by @ViewBag.Name;</h2>

  

    <div class="table-responsive">
        <table class="table align-middle table-borderless shadow-sm">
            <thead class="border-bottom border-2">
                <tr class="text-muted small text-uppercase">
                    <th>Item</th>
                    <th class="text-center">Quantity</th>
                    <th class="text-end">Price</th>
                    <th class="text-end">Size</th>

                    <th class="text-end">Total</th>
                    <th class="text-center">Remove</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var OrderItem in Model)
                {
                    double itemCost = OrderItem.Items.Price * OrderItem.Quantity;
                    orderCost += itemCost;

                    <tr class="border-bottom">
                        <td class="fw-semibold">@OrderItem.Items.Name</td>
                        <td class="text-center">@OrderItem.Quantity</td>
                        <td class="text-end text-muted">$@OrderItem.Items.Price.ToString("F2")</td>
                        <td class="text-center">@OrderItem.SizesReq</td>

                        <td class="text-end fw-bold text-success">$@itemCost.ToString("F2")</td>
                        <td class="text-center">
                            @if (OrderItem.Orders.StatusId == 1)
                            {
                                <form asp-action="Delete" method="post" style="display: inline;">
                                    <input type="hidden" name="itemId" value="@OrderItem.ItemId" />
                                    <button type="submit" title="Remove item" style="background: none; border: 1px solid red; color: red; padding: 2px 8px; font-size: 16px; cursor: pointer; border-radius: 4px;">
                                        ×
                                    </button>
                                </form>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="text-end mt-3">
        <h4>Total Cost: <span class="text-primary fw-bold">$@orderCost.ToString("F2")</span></h4>
    </div>

    <div class="text-center mt-4">
        @{
            var firstOrderItem = Model.FirstOrDefault();

            if (firstOrderItem != null && !User.IsInRole("Admin"))
            { 
                if (firstOrderItem.Orders.StatusId == 1 && !User.IsInRole("Admin"))
                {
                    <a class="btn btn-lg btn-success px-5" asp-controller="OrderItems" asp-action="ProcessOrder" asp-route-id="@ViewBag.orderId">Checkout</a>
                }
                else
                {
                    <div class="alert alert-success fw-bold">Thank you for your order!</div>
                }
            }
           
        }
    </div>
</div>
<button type="button" onclick="window.history.back()" class="btn btn-link p-0"
        style="color: teal !important; font-weight: bold; font-size: 1rem; text-decoration: underline; display: block; margin-top: 0.5rem;">
    Go back
</button>

                    <style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f9f9f9;
    }

    h1 {
        font-size: 2rem;
        font-weight: 600;
        letter-spacing: 0.5px;
    }


    .btn-outline-danger {
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .btn-outline-danger:hover {
        background-color: #e63946;
        color: #fff;
        border-color: #e63946;
    }

    .btn-success {
        background-color: #008080;
        border: none;
        transition: background-color 0.3s ease;
    }

    .btn-success:hover {
        background-color: #006666;
    }

    .text-primary {
        color: #008080 !important;
    }

</style>
